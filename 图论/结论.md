## 平面图

 * **定义**：能平面嵌入（能画在平面上并且边不交）的无向图。
   - 平面图$G=<V,E,F>$同无向图$G=<V,E>$
   - 面$F$：由$G$的一条或多条边所框出来的区域（内外都可以算）如果不含其它$E$和$V$的元素，就是一个面。
 * **平面图判定**：不能存在$5$个点能两两联通，或者两组各$3$个点（一共$6$个）能不同组两两联通（就是不存在完全图$K_5$或完全二分图$K_{3,3}$，其中“边”应该认为“联通”或“传递闭包后有边”）。
 * **平面图欧拉定理**：$v-e+f=c+1$,其中$v$是点数，$e$是边数，$f$是平面数（外面那个无限大的也算一个）,$c$是联通块个数（图中不一定只有一个联通块），如果只有一块则$c=1,v-e+f=2$



## 二分图基础

* **定义**：能把所有$n$个点划分成两个集合（点个数未必相等），使得每条边的两端点分属于不同集合的无向图。
* **二分图最大匹配**：二分图中取最多的边，使得任意两条边不经过同一个点。
  * 做法：【最大流】或【匈牙利算法】。对于最大流做法，注意到每个点只被最多一条边取到，建图显然。
* **二分图最优匹配/最大权匹配**：二分图中取边，使得任意两条边不经过同一个点，且边权和最大。
  - 做法：【KM算法】
* **二分图最小点覆盖**：取最少的点，使得二分图中的每条边都经过其中至少一个点。
  - 二分图最小点覆盖 $=$ 二分图最大匹配。
* **二分图最小边覆盖**：取最少的边，使得二分图中的每个点都经过其中至少一条边。
  * 这里已经假设了每个点都有边相连。如果存在点没有边相连，那么看情况：
    * 视为这个点不在图中，从$n$里剔除。
    * 视为无法做到边覆盖。答案为$-1$。
  * 二分图最小边覆盖 = $n$ $-$ 二分图最大匹配
* **二分图最大独立集**：在二分图中找一个点集，使得集合中任意两点之间没有边。（就像有向图的“反链”）
  * 二分图最大独立集 = $n$ $-$ 二分图最大匹配



## 有向无环图($DAG$)

* **链**：一个点集，对其中任意两点$x,y$，要么$x$能到达$y$，要么$y$能到达$x$。$DAG$不存在双方互通的情况。

* **反链**：一个点集，其中任意两点$x,y$，满足$x,y$都互不可达。（反链不是反着建边，是一个集合一样的东西）

  * 最长反链：最大的点集，其中任意两点$x,y$，满足$x,y$都互不可达。（感觉“最长”用词不是很恰当？）
  * 最长反链 = 最小可相交路径覆盖 （Dilworth定理）

* **最小可相交路径覆盖**：取最少的链，使得任意一个点都出现在至少一条链中，不同链允许经过同一点。

  * 最小链覆盖一般指的是最小可相交路径覆盖。
  * 最小可相交路径覆盖 = 对$DAG$做$floyd$处理 + 最小不相交路径覆盖

* **最小不相交路径覆盖**：取最少的链，使得任意一个点都出现且仅出现在一条链中，不同链不允许经过同一点。

  * 做法：拆成二分图做最大匹配。

    设原图$n$个点，每个点拆成两点$x,x'$，原图中一条单向边$(x,y)$对应新图中的**双向边**$(x,y')$。

    答案是（$n$ $-$ 新图的二分图最大匹配）。其中$n$指的是原图的点数。

## 一般有向图

 * 最小路径覆盖
   	* 做法：缩点之后，对新图求DAG最小路径覆盖即可。两类都一样。

## 2-SAT(2-可满足性问题)

* **定义**：有$n$个布尔变量，要么是$0$要么是$1$（实际问题中可对应$n$个物品取或不取），给出限制关系，比如$a=1$必须先有$b=1$，或者$a$和$b$不能取$1$，问有没有一组合法方案。

* 考虑拆点，每个变量拆成$2$个点$i$和$i'$,分别表示$1$和$0$。在图中加单向边$(i,j)$表示若选$i$必须选$j$（即选$i$不选$j$是不行的）。

  对于不同限制条件，建边如下：

  ```
  x=1                 : (x',x )
  x=0                 : (x ,x')
  x AND y == 1        : (x',x ),(y',y )
  x AND y == 0        : (y ,x'),(x ,y')	(x和y不能都选)
  x OR  y == 1        : (x',y ),(y',x )	(x和y不能都不选)
  x OR  y == 0        : (x ,x'),(y ,y')
  x XOR y == 1        : (x ,y'),(y ,x'),(y',x ),(x',y )	(x和y有且只有选一个)
  x XOR y == 0        : (x ,y ),(x',y'),(y ,x ),(y',x')	(x和y要么都选要么都不选)
  x AND (NOT y) == 0  : (x ,y'),(y ,x')
  (NOT x) AND y == 0  : (x',y'),(y ,x )
  ```

* 最后建出边只要$tarjan$判一下是不是存在同时包括了$i$和$i'$的环，如果有就是无解。

## 差分约束

### 什么是差分约束系统

对于一组不等式：
$$
\left\{\begin{matrix}
x_1-x_2 \le 0 \\
x_1-x_5 \le 1 \\
x_2-x_5 \le 1 \\
x_3 -x_1 \le 5 \\
x_4-x_1 \le 4  \\
x_4-x_3 \le -1 \\
x_5-x_3 \le -3 \\
x_5-x_4 \le -3
\end{matrix}\right.
$$
特点是全都是两个未知数的差**小于等于**某个常数（大于等于也可以，因为左右乘 $-1$ 就可以化成小于等于的形式），这样的不等式组称作**差分约束系统**。

这个不等式组**要么无解，要么就有无限组解**。因为如果存在一组解 $\{x_1,x_2,..,x_n\}$ 的话，那么对于任何一个常数 $k$ 有 $\{x_1+k,x_2+k,..,x_n+k\}$ 也肯定是一组解，因为任何两个数加上一个数以后，它们之间的关系（差）是不变的，这个差分约束系统中的所有不等式都不会被破坏。

### 与最短路的关系

差分约束系统的解法用到了**单源最短路径**问题中的三角形不等式。即对有向图中任意一条边 $<u,v>$ 都有： $dis[v] \le dis[u]+len[u][v]$ ，其中 $dis[u]$ 和 $dis[v]$ 是从源点分别到点 $u$ 和点 $v$ 的最短路径的长度，$len[u][v]$ 是边 $<u,v>$ 的长度值。

这是显然的：如果存在顶点 $u$ 到顶点 $v$ 的有向边，那么**从源点到顶点 $v$ 的最短路径长度** 小于等于**从源点到顶点 $u$ 的最短路径长度加上边 $<u,v>$ 的长度值**。

显然上述的不等式就是所描述的，也和差分约束系统中的不等式相同，因此就可以把差分约束系统转化成一张图。

### 构图求解

##### 基本构图

每个未知数 $x_i$ 对应图中的一个顶点 $v_i$ ，把所有的不等式都化成图中的一条边，对于不等式 $x_i-x_j \le y$ 化成三角形不等式 $x_i \le x_j+y$ 就可以化成边 $<v_j,v_i>$ 权值为 $y$ 。最后在这张图上求一遍**单源最短路**，这些三角不等式就全部满足了，因为它是最短路问题的基本性质。

![4](.\4.png)不等式组 $(1)$ 转化成 ![5](.\5.png)

##### 求解

以 $1$ 为起点，则起点到各个顶点的最短距离为 $dis[1]=0,dis[2]=0,dis[3]=5,dis[4]=4,dis[5]=1$ 则得到解 $x_1=0,x_2=1,x_3=5,x_4=4,x_5=1$ 

以 $3$ 为起点，则起点到各个顶点的最短距离为 $dis[1]=-5,dis[2]=-5,dis[3]=0,dis[4]=-1,dis[5]=-4$ 则得到解 $x_1=-5,x_2=-4,x_3=0,x_4=-1,x_5=-4$ 

以不同顶点作为起点会得到不同的解，但这些解都一定合理。

- 什么情况下无解？ **存在负权回路！**

##### 增加源点

具体实现时，往往在原图上附加一个顶点，这个顶点与每个顶点都连接一条权值为 $0$ 的边，以上述不等式为例，也就是新加入一个未知数 $x_0$ ，然后对每个未知数都对 $x_0$ 加一个不等式，得到![6](.\6.png)这样的不等式组 $(2)$ ，化成顶点图![7](.\7.png)

图中**每一条边**都代表差分约束系统的**一个不等式**。现在以 $v_0$ 为源点，求单源最短路，**最终得到的$v_0$ 到 $v_i$ 的最短路径长度就是 $x_i$ 的一个解**。如图中 $v_0$ 到其他各个顶点的最短距离分别是 $\{-5,-3,0,-1,-4\}$ ，因此满足上述不等式的一组解就是 $\{x_1,x_2,x_3,x_4,x_5\}=\{-5,-3,0,-1,-4\}$ 。当然把每个数都加上 $10$ 也是一组解 $\{5,7,10,9,6\}$ ，但是这组解只满足不等式组 $(1)$ ，也就是原先的差分约束系统，而不满足不等式组 $(2)$ ，也是我们后来加上的那些不等式。当然这是无关紧要的，因为 $x_0$ 本来就是个局外人，并不在乎它。

对于上面例子而言，它代表的解 $x_0$ 值也在其中也就是 $x_0=0$ 。但是 $x_0$ 的值是无可争议的，既然是以它作为源点求最短路径，那么源点到它的最短路径当然是 $0$ 了，因此，我们解这个差分约束系统无形中存在一个条件 $x_0=0$ ，那么它有什么用呢？**可以限制所有的未知数的解都不大于0** 。

- 一个有趣的结论：**当我们一开始就把 $x_0$ 的解死定为 $A$ 的时候，所有未知数的解都不会大于 $A$ （一开始把 $dis[0]=A$）** 

### 总结

差分约束求解不等式组分为两种方法：**最短路**和**最长路**。其中最短路对应最大解，最长路对应最小解，特别地，若有 $x_i=x_j$ 的情况，建图时候，从 $x_i$ 出发连一条权值为 $0$ 的边到 $x_j$ ，同时也建一条同等权值的反向边。

## 图的割点、桥和双连通分支的基本概念

**点连通度与边连通度：** 在一个无向连通图中，如果有一个顶点集合，删除这个顶点集合，以及这个集合中所有顶点相关联的边以后，原图变成多个连通块，就称这个点集为割点集合。一个图的点连通度的定义为，最小割点集合中的顶点数。

**双连通图、割点与桥：**

+ 如果一个无向连通图的点连通度大于1，则称该图是点双连通的(point biconnected)，简称双连通或重连通。一个图有割点，当且仅当这个图的点连通度为1，则割点集合的唯一元素被称为割点(cut point)，又叫关节点(articulation point)。
+ 如果一个无向连通图的边连通度大于1，则称该图是边双连通的(edge biconnected)，简称双连通或重连通。一个图有桥，当且仅当这个图的边连通度为1，则割边集合的唯一元素被称为桥(bridge)，又叫关节边(articulation edge)。

可以看出，点双连通与边双连通都可以简称为双连通，它们之间是有着某种联系的，下文中
提到的双连通，均既可指点双连通，又可指边双连通。

**双联通分支：** 在图G 的所有子图G'中，如果G'是双连通的，则称G'为双连通子图。如果一个双连通子图G' 它不是任何一个双连通子图的真子集，则G’ 为极大双连通子图。双连通分支(biconnected component)，或重连通分支，就是图的极大双连通子图。特殊的，点双连通分支又叫做块。

**求割点与桥：** 该算法是 R.Tarjan 发明的。对图深度优先搜索，定义 $DFS(u)$ 为 $u$ 在搜索树（以下简称为树）中被遍历到的次序号。定义 $Low(u)$ 为 $u$ 或 $u$ 的子树中能通过非父子边追溯到的最早的节点，即 $DFS$ 序号最小的节点。根据定义，则有：$Low(u)=Min\{ DFS(u), DFS(v)\}$ $(u,v)$ 为后向边(返祖边) 等价于 $DFS(v)<DFS(u)$ 且 $v$ 不为 $u$ 的父亲节点 $Low(v)$ $(u,v)$ 为树枝边(父子边) 一个顶点 $u$ 是割点，当且仅当满足 $(1)$ 或 $(2)$

1. $u$ 为树根，且 $u$ 有多于一个子树。
2. $u$ 不为树根，且满足存在 $(u,v)$ 为树枝边(或称父子边，即 $u$ 为 $v$ 在搜索树中的父亲)，使得 $DFS(u)\le Low(v)$。

一条无向边 $(u,v)$ 是桥，当且仅当 $(u,v)$ 为树枝边，且满足 $DFS(u)<Low(v)$。

**求双连通分支：** 下面要分开讨论点双连通分支与边双连通分支的求法。

+ 对于点双连通分支，实际上在求割点的过程中就能顺便把每个点双连通分支求出。建立一个栈，存储当前双连通分支，在搜索图时，每找到一条树枝边或后向边(非横叉边)，就把这条边加入栈中。如果遇到某时满足DFS(u)<=Low(v)，说明u 是一个割点，同时把边从栈顶一个个取出，直到遇到了边(u,v)，取出的这些边与其关联的点，组成一个点双连通分支。割点可以属于多个点双连通分支，其余点和每条边只属于且属于一个点双连通分支。
+ 对于边双连通分支，求法更为简单。只需在求出所有的桥以后，把桥边删除，原图变成了多个连通块，则每个连通块就是一个边双连通分支。桥不属于任何一个边双连通分支，其余的边和每个顶点都属于且只属于一个边双连通分支。

**构造双连通图：**

一个有桥的连通图，如何把它通过加边变成边双连通图？方法为首先求出所有的桥，然后删除这些桥边，剩下的每个连通块都是一个双连通子图。把每个双连通子图收缩为一个顶点，再把桥边加回来，最后的这个图一定是一棵树，边连通度为1。

统计出树中度为 1 的节点的个数，即为叶节点的个数，记为leaf。则至少在树上添加(leaf+1)/2 条边，就能使树达到边二连通，所以至少添加的边数就是(leaf+1)/2。具体方法为，首先把两个最近公共祖先最远的两个叶节点之间连接一条边，这样可以把这两个点到祖先的路径上所有点收缩到一起，因为一个形成的环一定是双连通的。然后再找两个最近公共祖先最远的两个叶节点，这样一对一对找完，恰好是(leaf+1)/2 次，把所有点收缩到了一起。

## 生成树计数

矩阵树定理(Matrix-Tree) - 基尔霍夫矩阵（Kirchhoff）定理：

+ $G$ 的度数矩阵 $D[G]$ 是一个 $n\times n$ 的矩阵
  + 当 $i\neq j$ 时，$d[i,j]=0$
  + 当 $i=j$ 时，$d[i,i]=degree[i]$
+ $G$ 的邻接矩阵 $A[G]$ 也是一个 $n\times n$ 的矩阵
  + 如果 $u$ 和 $v$ 有直接边相连， $a[u,v]=1$
  + 如果 $u$ 和 $v$ 不直接相连，$a[u,v]=0$

定义 $G$ 的基尔霍夫矩阵 $C[G]=D[G]-A[G]$，那么矩阵树定理可以描述为：

$G$ 的所有不同的生成树的个数等于其基尔霍夫矩阵 $C[G]$ 的任何一个 $n-1$ 阶主子式的行列式的绝对值。

+ $n-1$ 阶主子式：矩阵 $M$ 删除第 $x$ 行和列后的新的 $n-1$ 阶矩阵

## 欧拉回路

**欧拉回路：** 每条边只经过一次，而且回到起点

**欧拉路径：** 每条边只经过一次，不要求回到起点

**欧拉回路判断：**

+ **无向图：** 连通（不考虑度为 0 的点），每个顶点度数都为偶数。
+ **有向图：** 基图连通（把边当成无向边，同样不考虑度为 0 的点），每个顶点出度等于入度。
+ **混合图（有无向边和有向边）：** 首先是基图连通（不考虑度为 0 的点），然后需要借助网络流判定。

首先给原图中的每条无向边随便指定一个方向（称为初始定向），将原图改为有向图 G’，然
后的任务就是改变 G’ 中某些边的方向（当然是无向边转化来的，原混合图中的有向边不能动）使其满足每个点的入度等于出度。

设 $D[i]$ 为 G’ 中(点 $i$ 的出度 $-$ 点 $i$ 的入度）。可以发现，在改变 G’ 中边的方向的过程中，任何点的 $D$ 值的奇偶性都不会发生改变（设将边 $<i, j>$ 改为 $<j, i>$，则 $i$ 入度加 1 出度减 1，$j$ 入度减 1 出度加 1，两者之差加 2 或减 2，奇偶性不变）而最终要求的是每个点的入度等于出度，即每个点的 $D$ 值都为 0，是偶数，故可得：若初始定向得到的 G’ 中任意一个点的 $D$ 值是奇数，那么原图中一定不存在欧拉环！

**欧拉路径的判断：**

+ **无向图：** 连通（不考虑度为 0 的点），每个顶点度数都为偶数或者仅有两个点的度数为偶数。
+ **有向图：** 基图连通（把边当成无向边，同样不考虑度为 0 的点），每个顶点出度等于入度或者有且仅有一个点的出度比入度多1，有且仅有一个点的出度比入度少1，其余出度等于入度。
+ **混合图：** 如果存在欧拉回路，一点存在欧拉路径了。否则如果有且仅有两个点的（出度 $-$ 入度）是奇数，那么给这个两个点加边，判断是否存在欧拉回路。


## 有上下界网络流

**问题提出：** 给出由 $n$ 点 $m$ 边的有向网络图，每条边有容量下限 $L$ 和上限 $R$，即流量必须在区间 $[L,R]$ 内。

### 无源汇可行流

没有源点和汇点，问是否存在满足限制的一道流（判定问题）

**解法：** 将原来容量 $[L,R]$ 边拆成两条没有下限的边容量分别为 $L$ 和 $R-L$，前者为必要弧。增加 $x$ 和 $y$，并且令 $c[x,y]=\infin$，每个必要弧改成统一由 $y$ 进入，由 $x$ 统一流出，有可行流的充要条件是删掉边 $(x,y)$ 后从 $x$ 到 $y$ 跑最大流能够满流。

### 有源汇可行流

**解法：** 从汇点到源点建一条容量为 $\infin$ 边，问题转换为无源汇。

### 有源汇最大流

**解法：** 从汇点 $t$ 到源点 $s$ 建边成为无源汇的网络，二分最大流的值，作为从 $t$ 到 $s$ 的边的容量，判断如果存在可行流，说明合法，反之不合法。

## 二分图匹配最大流算法

在原图点集基础上增加源 $s$ 和汇 $t$：

+ 将每条二分图的边 $<u,v>\in E$ 替换为容量为 $c[u,v]=\infin$ 的有向边 $<u,v>\in E_N$
+ 增加源 $s$ 到二分图 $X$ 部分的点 $u$ 的有向边 $<s,u>\in E_N$，容量为该点权值（如果权为1则 $w=1$） $c[s,u]=w_u$
+ 增加二分图 $Y$ 部分的点 $v$ 到汇 $t$ 的有向边 $<v,t>\in E_N$，同样 $c(v,t)=w_v$

![3](.\3.png)

## 分数规划

**一般形式：** 
$$
\texttt{Minimize}\ \lambda=f(x)=\frac{a(x)}{b(x)}\ (x\in S)
\\ st.\ \forall x\in S,\ b(x)>0
$$
 其中解向量 $x$ 在解空间 $S$ 内，$a(x)$ 与 $b(x)$ 都是**连续的实值函数**。

**解法：** 参数搜索法，对答案进行猜测，再验证其最优性，将优化问题转化为判定问题或其他的优化问题。假设 $\lambda ^* =f(x^*)$ 为该规划的最优解，有：
$$
\lambda ^*=f(x^*)=\frac{a(x^*)}{b(x^*)}
\\ \Rightarrow \lambda ^*\cdot b(x^*)=a(x^*)
\\\ \ \ \ \ \  \Rightarrow a(x^*)-\lambda ^*\cdot b(x^*)=0
$$
由上面的形式构造一个新函数 $g(\lambda)$：$g(\lambda)=\texttt{min}\{a(x)-\lambda\cdot b(x)\}, \ x\in S$，那么有以下结论：

+ $g(\lambda)$ 是一个严格递减函数，即对于 $\lambda_1<\lambda_2$，一定有 $g(\lambda_1)>g(\lambda_2)$
+ $g(\lambda)=0$ 当且仅当 $\lambda=\lambda^*$

可以推出如下结论，发现可以对参数进行二分搜索。
$$
\left\{\begin{matrix}
g(\lambda)=0 \Leftrightarrow \lambda=\lambda^*
\\ g(\lambda)<0 \Leftrightarrow \lambda>\lambda^*
\\ g(\lambda)>0 \Leftrightarrow \lambda<\lambda^*

\end{matrix}\right.
$$

## 最大权闭合图

**问题提出：** 有向图中（不一定非得是 DAG）有边 $(u,v)$，如果选择 $u$ 必须选择 $v$，这样选择出来的图叫做**闭合图**。闭合图某点有权值，则悬着出来的闭合图权值最大的问题叫最大权闭合图问题。

![1](.\1.png)

**解法：** 转化为网络流模型，构图如下

1. 添加超级源点 $s$ 和汇点 $t$
2. 原图中 $(u,v)$ 容量设为 $c[u,v]=\infin$
3. 如果某个点权 $v$ 为正，则向源点 $s$ 连边，容量为该点权值 $c[s,v]=w[v]$
4. 如果某个点权 $v$ 为负，则向汇点 $t$ 连边，容量为该点权值相反数 $c[v,t]=-w[v]$

![2](.\2.png)

答案就是 $\sum_{v\in V^+}w[v]-c[s,t]$，其中 $c[s,t]$ 是新图的最小割。

**性质：**

1. 此网络流的割中的每条边，包含了 $s$ 或者 $t$（称为简单割）
2. 以割为界，靠近 $s$ 的一侧的点属于最大权闭合图的点，靠近 $t$ 的点不属于（因此找最大权闭合图可以从 $s$ 按照残余流量进行 $dfs$）
3. 最大权闭合图的权 = 原图中权值为正的点的和 $-$ 最大流（最小割）
4. 如果求最小权闭合图，则将原图中正负对换即可

## 最大密度子图

**问题提出：** 无向图 $G=<V,E>$ $n$ 个点 $m$ 条边，选择一个子图 $G'=<V',E'>$ 使得 $\frac{|E'|}{|V'|}$ 最大

**分析：** 

1. 对于无向图 $G$ 中，有一个密度为 $D$ 的子图 $G'$，且在无向图 $G$ 中不存在一个密度超过 $D+\frac{1}{n^2}$ （$\frac{1}{n^2}$ 是精度）的子图，那么 $G'$ 就是最大密度子图。
2. 设 $g=\frac{|E'|}{|V'|}$，要让 $g$ 最大，就要让 $h(g)=|E'|-g\cdot |V'|$ 最大，因此参数搜索 $g$。
   + 当 $h(g)>0$ 时，密度 $g$ 偏小，存在更大密度的子图；
   + 当 $h(g)<0$ 时，密度 $g$ 偏大，不存在子图
   + 当 $h(g)=0$ 时，不考虑

**解法：** 0-1分数规划+网络流判定

+ 主代码

```c++
double l=0, r=U, eps = 1/(n*n);
while (r-l > eps) {
    g = (l+r)/2.0;
    h = search(g); // 参数搜索
    if (h > 0) l = g;
    else r = g;
} // 结束后 l 是密度
```

+ 搜索流程
  + 构图过程：
    1. 新图中增加超级源点 $S$ 和超级汇点 $T$
    2. 原图中的边 $<u,v>$ 在新图中分别增加 $<u,v>$ 容量 $c[u,v]=1.0$，和 $<v,u>$ 容量 $c[v,u]=1$
    3. 对原图中每个点 $i$，在新图中增加边 $<S,i>$ 容量 $c[S,i]=U$，和边 $<i,T>$ 容量 $c[i,T]=U+2\cdot g-d_i$，其中 $d_i$ 是原图中节点 $i$ 的度数 
  + 假设新图最大流（最小割） $c[S,T]=flow$，那么本次搜索答案 $h(g)=\frac{U\cdot n-flow}{2}$

**注意：**

1. `search` 中其实没有返回 $h(g)<0$ 的情况，但不影响运算。
2. 找最大密度子图 $G'$ 结束搜索以后应该先跑一遍 `search(l)`，然后在残余流量中 $dfs$，靠近 $S$ 一侧的点就是。
3. 若最后 $l=0$，说明所有的点都是鼓励的，任何一个点都是最大密度子图。

**扩展：**

1. 边带权 $w$（非负）。这种情况实质上是两个点之间增加或减少一些边（可能是分数）

   + 令 $U=\sum w_i$
   + 把精度变小一点搜索，其中每个边 $<u,v>$ 原来的的权（1.0）变成 $w[u,v]$，每个点度数 $d_i$ 变成与点 $i$ 相连的边权和

2. 边带权 $w$（非负），点带权 $p$（实数），使得【 (点权和+边权和) /|V'】最大

   + 令 $U=2\cdot \sum\limits_{v\in V} |p_i|+\sum\limits_{e\in E}w_e$
     + 注意绝对值
   + 把精度变小一点搜索，$<u,v>$ 原来的权（1.0）变成 $w[u,v]$，度数 $d_i$ 变成与点 $i$ 相连的所有边权和 $+2\cdot p_i$

   